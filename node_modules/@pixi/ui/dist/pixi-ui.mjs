/*!
 * @pixi/ui - v0.3.0
 * Compiled Tue, 10 Jan 2023 14:40:42 UTC
 *
 * @pixi/ui is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2023, PixiJS Team, All Rights Reserved
 */import{utils as S,Texture as g,Rectangle as C,Point as _,Ticker as F}from"@pixi/core";import{Container as u}from"@pixi/display";import{Signal as x}from"typed-signals";import{Sprite as p}from"@pixi/sprite";import{Text as b,TextStyle as R}from"@pixi/text";import{Graphics as m}from"@pixi/graphics";class y extends u{constructor({view:t,hoverView:i,pressedView:s,disabledView:e,textView:h,padding:o,textOffset:n}){var a,c,d,w;if(super(),this.padding=0,o&&(this.padding=o*2),this.defaultView=t,this.defaultView.zIndex=1,this.addChild(this.defaultView),i&&(this.hoverView=i,this.hoverView.zIndex=2,this.addChild(this.hoverView),this.hoverView.visible=!1),s&&(this.pressedView=s,this.pressedView.zIndex=3,this.addChild(this.pressedView),this.pressedView.visible=!1),e&&(this.disabledView=e,this.disabledView.zIndex=4,this.addChild(this.disabledView),this.disabledView.visible=!1),h&&(this.text=h,this.text.zIndex=4,h.anchor.set(.5),h.x=this.width/2+((a=n==null?void 0:n.x)!=null?a:0),h.y=this.height/2+((c=n==null?void 0:n.y)!=null?c:0),this.addChild(this.text),h.width+this.padding>((d=this.defaultView)==null?void 0:d.width))){const l=(w=this.defaultView)==null?void 0:w.width;h.scale.set(l/(h.width+this.padding))}this._enabled=!0,this.onPress=new x,this.onDown=new x,this.onUp=new x,this.onHover=new x,this.onOut=new x,this.onUpOut=new x,this.on("pointerdown",l=>{this._isDown=!0,this.onDown.emit(this,l)}),this.on("pointerup",l=>{this._processUp(l)}),this.on("pointerupoutside",l=>{this._processUpOut(l)}),this.on("pointertap",l=>{this._isDown=!1,this.onPress.emit(this,l)}),this.on("pointerover",l=>{this.onHover.emit(this,l)}),this.on("pointerout",l=>{this._processOut(l)}),this.onDown.connect((l,v)=>{this.down(v),this.pressedView&&(this.pressedView.visible=!0)}),this.onUp.connect((l,v)=>{this.up(v),this.pressedView&&(this.pressedView.visible=!1)}),this.onUpOut.connect((l,v)=>{this._upOut(v),this.pressedView&&(this.pressedView.visible=!1)}),S.isMobile.any||this.onHover.connect((l,v)=>{this.hoverView&&(this.hoverView.visible=!0),this.hover(v)}),this.onOut.connect((l,v)=>{this.hoverView&&(this.hoverView.visible=!1),this._out(v)}),this._isDown=!1,this.enabled=!0}down(t){}up(t){}hover(t){}getText(){return this.text.text}get isDown(){return this._isDown}set enabled(t){this._enabled=t,this.interactive=t,this.cursor=t?"pointer":"default",this.disabledView&&(this.disabledView.visible=!t),t||this._processUp()}get enabled(){return this._enabled}set shown(t){this._shown=t,this.enabled=t,this.defaultView&&(this.defaultView.visible=t)}get shown(){return this._shown}_processUp(t){this._isDown&&this.onUp.emit(this,t),this._isDown=!1}_processUpOut(t){this._isDown&&this.onUpOut.emit(this,t),this.pressedView&&(this.pressedView.visible=!1),this._isDown=!1}_processOut(t){this.onOut.emit(this,t),this._isDown=!1}_upOut(t){this.up(t)}_out(t){this.up(t)}}class I extends u{constructor(t,i=0){super(),this.view=new u,this.views=[],this.activeViewID=0,t.forEach((s,e)=>{this.view.addChild(s),s.visible=e===this.activeViewID}),this.views=t,this.activeViewID=i,this.button=new y({view:this.view}),this.addChild(this.button),this.onChange=new x,this.button.onPress.connect(()=>{this.switch(),this.onChange.emit(this.activeViewID)})}get activeView(){return this.views[this.activeViewID]}switch(t){this.activeView.visible=!1,this.activeViewID=t===void 0?this.activeViewID+1:t,this.activeViewID>this.views.length-1&&(this.activeViewID=0);const i=this.views[this.activeViewID];i.visible=!0}}class T extends I{constructor(t){const i=typeof t.style.unchecked=="string"?new p(g.from(t.style.unchecked)):t.style.unchecked,s=typeof t.style.checked=="string"?new p(g.from(t.style.checked)):t.style.checked;super([i,s],t.checked?1:0),t.text&&(this.label=new b(t.text,t.style.text),this.label.x=i.width+10,this.label.y=(i.height-this.label.height)/2,i.addChild(this.label),this.label=new b(t.text,t.style.text),this.label.x=s.width+10,this.label.y=(s.height-this.label.height)/2,s.addChild(this.label)),this.update(),this.onChange=new x}update(){this.hitArea=new C(0,0,this.width,this.height)}set text(t){this.label.text=t,this.update()}get text(){return this.label.text}get checked(){return this.activeViewID===1}set checked(t){this.switch(t?1:0),this.update()}}function M(...r){r.forEach(t=>t&&(t.hitArea=new C))}class H extends u{constructor(t){var i,s,e,h;super(),this.dragging1=0,this.dragging2=0,this.percent1=0,this.percent2=100,this.value1=0,this.value2=0,this.onChange=new x,this.options=t;const o=typeof t.bg=="string"?new p(g.from(t.bg)):t.bg;if(this.bg=new u,this.bg.addChild(o),this.addChild(this.bg),t.fill){const c=typeof t.fill=="string"?new p(g.from(t.fill)):t.fill;this.fill=new u,this.fill.addChild(c);const d=(s=(i=t.fillOffset)==null?void 0:i.x)!=null?s:0,w=(h=(e=t.fillOffset)==null?void 0:e.y)!=null?h:0;this.fill.x=(this.bg.width-this.fill.width)/2+d,this.fill.y=(this.bg.height-this.fill.height)/2+w,this.fillMask=new m,this.fill.addChild(this.fillMask),this.fill.mask=this.fillMask,this.addChild(this.fill)}const n=typeof t.slider1=="string"?new p(g.from(t.slider1)):t.slider1;n instanceof p&&n.anchor.set(.5),n.x=n.width/2,this.slider1=new u,this.slider1.addChild(n),this.slider1.y=this.bg.height/2;const a=typeof t.slider2=="string"?new p(g.from(t.slider2)):t.slider2;a instanceof p&&a.anchor.set(.5),a.x=a.width/2,this.slider2=new u,this.slider2.addChild(a),this.slider2.y=this.bg.height/2,this.addChild(this.slider2,this.slider1),t.showValue&&(this.slider1Text=new b("",t.valueTextStyle||{fill:16777215}),this.slider1Text.anchor.set(.5),this.addChild(this.slider1Text)),t.showValue&&(this.slider2Text=new b("",t.valueTextStyle||{fill:16777215}),this.slider2Text.anchor.set(.5),this.addChild(this.slider2Text)),this.validateSettings(),this.makeScrollable(),this.update()}validateSettings(){var t,i,s,e;const{options:h}=this;h.min||(h.min=0),h.max||(h.max=100),h.value1<h.min&&(h.value1=h.min),h.value2>h.max&&(h.value2=h.max),this.value1=(i=(t=h.value1)!=null?t:h.min)!=null?i:0,this.percent1=this.value1*100/h.max,this.value2=(e=(s=h.value2)!=null?s:h.min)!=null?e:0,this.percent2=this.value2*100/h.max;const o=h.max-h.min,n=this.value1-h.min,a=this.value2-h.min;this.percent1=n*100/o,this.percent2=a*100/o}makeScrollable(){this.interactive=!0,this.slider1.interactive=!0,this.slider2.interactive=!0,this.bg.interactive=!0;const{onDragStart1:t,onDragMove1:i,onDragEnd1:s,onSetByClick:e,onDragStart2:h,onDragMove2:o,onDragEnd2:n}=this;this.slider1.on("pointerdown",t,this).on("pointermove",i,this).on("pointerup",s,this).on("pointerupoutside",s,this),this.slider2.on("pointerdown",h,this).on("pointermove",o,this).on("pointerup",n,this).on("pointerupoutside",n,this),this.bg.on("pointerdown",e,this),this.on("pointerupoutside",s,this),M(this.fill,this.slider1Text,this.slider2Text)}onSetByClick(t){var i;let s=t.currentTarget.parent.worldTransform.applyInverse(t.global).x-this.slider2.width/2;s<0&&(s=0);const e=this.bg.width-this.slider2.width;if(s>e&&(s=e),s<this.slider1.x)this.setSlider1Val(s);else if(s>this.slider2.x)this.setSlider2Val(s);else{const h=s-this.slider1.x,o=this.slider2.x-s;h<o?this.setSlider1Val(s):this.setSlider2Val(s)}this.update(),(i=this.onChange)==null||i.emit(this.value1,this.value2)}onDragStart1(t){const i=t.currentTarget;i.dragData=t,this.dragging1=1,i.dragPointerStart=i.parent.worldTransform.applyInverse(t.global),i.dragObjStart=new _,i.dragObjStart.copyFrom(i.position),i.dragGlobalStart=new _,i.dragGlobalStart.copyFrom(t.data.global)}onDragMove1(t){var i,s;const e=t.currentTarget;if(!this.dragging1)return;const h=e.dragData;if(this.dragging1===1&&Math.abs(h.global.x-((i=e.dragGlobalStart)==null?void 0:i.x))+Math.abs(h.global.y-((s=e.dragGlobalStart)==null?void 0:s.y))>=3&&(this.dragging1=2),this.dragging1===2){const o=e.parent.worldTransform.applyInverse(h.global);let n=e.dragObjStart.x+(o.x-e.dragPointerStart.x);n<0&&(n=0),n>this.slider2.x&&(n=this.slider2.x);const a=this.bg.width-this.slider1.width;n>a&&(n=a),this.setSlider1Val(n),this.update()}}setSlider1Val(t){const i=this.bg.width-this.slider1.width;this.percent1=Math.round(t/i*100),this.value1=this.options.min+Math.round((this.options.max-this.options.min)/100*this.percent1)}onDragEnd1(){var t;this.dragging1&&(this.dragging1=0,(t=this.onChange)==null||t.emit(this.value1,this.value2))}onDragStart2(t){const i=t.currentTarget;i.dragData=t.data,this.dragging2=1,i.dragPointerStart=i.parent.worldTransform.applyInverse(t.global),i.dragObjStart=new _,i.dragObjStart.copyFrom(i.position),i.dragGlobalStart=new _,i.dragGlobalStart.copyFrom(t.data.global)}onDragMove2(t){var i,s;const e=t.currentTarget;if(!this.dragging2)return;const h=e.dragData;if(this.dragging2===1&&Math.abs(h.global.x-((i=e.dragGlobalStart)==null?void 0:i.x))+Math.abs(h.global.y-((s=e.dragGlobalStart)==null?void 0:s.y))>=3&&(this.dragging2=2),this.dragging2===2){const o=e.parent.worldTransform.applyInverse(h.global);let n=e.dragObjStart.x+(o.x-e.dragPointerStart.x);n<this.slider1.x&&(n=this.slider1.x);const a=this.bg.width-this.slider2.width;n>a&&(n=a),this.setSlider2Val(n),this.update()}}setSlider2Val(t){const i=this.bg.width-this.slider2.width;this.percent2=Math.round(t/i*100),this.value2=this.options.min+Math.round((this.options.max-this.options.min)/100*this.percent2)}onDragEnd2(){var t;this.dragging2&&(this.dragging2=0,(t=this.onChange)==null||t.emit(this.value1,this.value2))}update(){var t,i,s,e,h,o,n,a,c;const d=(this.bg.width-this.slider1.width)/100*this.percent1,w=(this.bg.width-this.slider2.width)/100*this.percent2;this.slider1.x=d,this.slider2.x=w;const l=this.bg.width/100*this.percent1,v=this.bg.width/100*this.percent2;if(this.fillMask&&this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(l,0,v-l,this.fill.height),this.options.showValue){this.slider1Text.text=this.value1,this.slider2Text.text=this.value2;const f=this.slider1.x+this.slider1.width/2,A=this.slider1.y;this.slider1Text.x=f+((i=(t=this.options.valueTextOffset)==null?void 0:t.x)!=null?i:0),this.slider1Text.y=A+((e=(s=this.options.valueTextOffset)==null?void 0:s.y)!=null?e:0);const O=this.slider2.x+this.slider2.width/2,G=this.slider2.y;this.slider2Text.x=O+((o=(h=this.options.valueTextOffset)==null?void 0:h.x)!=null?o:0),this.slider2Text.y=G+((a=(n=this.options.valueTextOffset)==null?void 0:n.y)!=null?a:0)}(c=this.onChange)==null||c.emit(this.value1,this.value2)}}class z extends u{constructor(t){var i,s;super(),this.editing=!1,this.tick=0,this.activation=!1,this.options=t,this.bg=typeof t.bg=="string"?new p(g.from(t.bg)):t.bg,this.bg.cursor="text",this.bg.interactive=!0;const e={fill:0,align:"center"},h=new R((i=t.textStyle)!=null?i:e);if(this.inputField=new b("",h),this.inputMask=new m().beginFill(16777215).drawRect(this.padding,this.padding,this.bg.width-this.padding*2,this.bg.height-this.padding*2),this._cursor=new p(g.WHITE),this._cursor.tint=Number(t.textStyle.fill)||0,this._cursor.anchor.set(.5),this._cursor.width=2,this._cursor.height=this.inputField.height*.8,this._cursor.alpha=0,this.inputField.mask=this.inputMask,this._cursor.mask=this.inputMask,this.placeholder=new b(t.placeholder,h!=null?h:e),this.placeholder.visible=!!t.placeholder,this.value=(s=t.value)!=null?s:"",this.addChild(this.bg,this.inputField,this.placeholder,this._cursor,this.inputMask),this.align(),this.cursor="text",this.interactive=!0,this.on("pointertap",()=>this.activation=!0),S.isMobile.any){window.addEventListener("touchstart",()=>this.handleActivation());let o=document.getElementById("v-keyboard");o||(o=document.createElement("input"),document.body.appendChild(o),o.setAttribute("id","v-keyboard"),o.style.opacity="0"),o.oninput=()=>{let n=o.value;const a=this.options.maxLength;a&&n.length>this.options.maxLength&&(n=n.substring(0,a),o.value=n),this.value=n,this.onChange.emit(this.value)}}else window.addEventListener("click",()=>{this.handleActivation(),this.onEnter.emit(this.value)}),window.addEventListener("keydown",o=>{const n=o.key;n==="Backspace"?this._delete():n==="Escape"||n==="Enter"?(this.stopEditing(),this.onEnter.emit(this.value)):n.length===1&&this._add(n)});this.onEnter=new x,this.onChange=new x}_add(t){this.editing&&(this.options.maxLength&&this.value.length>=this.options.maxLength||(this.value=this.value+t,this.onChange.emit(this.value)))}_delete(){if(!this.editing||this.value.length===0)return;const t=this.value.split("");t.pop(),this.value=t.join(""),this.onChange.emit(this.value)}_startEditing(){if(this.tick=0,this.editing=!0,this.placeholder.visible=!1,this._cursor.alpha=1,S.isMobile.any){const t=document.getElementById("v-keyboard");t.focus(),t.click(),t.value=this.value}this.align()}handleActivation(){this.stopEditing(),this.activation&&(this._startEditing(),this.activation=!1)}stopEditing(){var t;this._cursor.alpha=0,this.editing=!1,this.inputField.text===""&&(this.placeholder.visible=!0),this.value.length===0&&(this.placeholder.visible=!0),S.isMobile.any&&((t=document.getElementById("v-keyboard"))==null||t.blur()),this.align()}update(t){this.editing&&(this.tick+=t*.1,this._cursor.alpha=Math.round(Math.sin(this.tick)*.5+.5))}align(){const t=this.getAlign();this.inputField.anchor.set(t,.5),this.inputField.x=this.bg.width*t+(t===1?-this.padding:this.padding),this.inputField.y=this.bg.height/2,this.placeholder.anchor.set(t,.5),this.placeholder.x=this.bg.width*t+(t===1?-this.padding:this.padding),this.placeholder.y=this.bg.height/2,this._cursor.x=this.getCursorPosX(),this._cursor.y=this.inputField.y}get padding(){return this.options.padding|0}getAlign(){const t=this.bg.width*.95;if(this.inputField.width+this.padding*3>t)return this.editing?1:0;switch(this.options.align){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}getCursorPosX(){switch(this.getAlign()){case 0:return this.inputField.x+this.inputField.width;case .5:return this.inputField.x+this.inputField.width*.5;case 1:return this.inputField.x;default:return 0}}set value(t){this.inputField.text=t,t.length!==0?this.placeholder.visible=!1:this.placeholder.visible=!this.editing,this.align()}get value(){return this.inputField.text}}class k extends u{constructor(t){super(),this.children=[],this.options=t,t!=null&&t.type&&(this.type=t.type),t!=null&&t.children&&t.children.map(i=>this.addChild(i))}onChildrenChange(){var t,i,s,e,h,o;let n=(i=(t=this.options)==null?void 0:t.horPadding)!=null?i:0,a=(e=(s=this.options)==null?void 0:s.vertPadding)!=null?e:0;const c=(o=(h=this.options)==null?void 0:h.elementsMargin)!=null?o:0;this.children.forEach(d=>{var w,l;switch(!this.type&&n+d.width>=this.parent.width?(a+=c+d.height,n=(l=(w=this.options)==null?void 0:w.horPadding)!=null?l:0,d.x=n,d.y=a,this.h=a):(d.x=n,d.y=a),this.type){case"horizontal":n+=c+d.width,this.w=n,this.h=d.height;break;case"vertical":a+=c+d.height,this.h=a,this.w=d.width;break;default:n+=c+d.width,this.w=n;break}})}}function j(r,...t){const i=[];return t.forEach(s=>i.push(s)),new k({type:"horizontal",elementsMargin:r,children:i})}function U(r,...t){const i=[];return t.forEach(s=>i.push(s)),new k({type:"vertical",elementsMargin:r,children:i})}class L extends u{constructor({target:t,mask:i,borderWidth:s,borderColor:e}){if(super(),this.target=typeof t=="string"?new p(g.from(t)):t,this.targetMask=typeof i=="string"?new p(g.from(i)):i,this.target.addChild(this.targetMask),this.target.mask=this.targetMask,s){this.border=new m().beginFill(e).drawRect(0,0,this.target.width+s*2,this.target.height+s*2),this.target.x=s,this.target.y=s;const h=typeof i=="string"?new p(g.from(i)):i.clone();h.width+=s*2,h.height+=s*2,this.border.mask=h,this.border.addChild(h),this.addChild(this.border)}this.addChild(this.target)}showBorder(){this.border&&(this.border.visible=!0)}hideBorder(){this.border&&(this.border.visible=!1)}}class W extends u{constructor(t){super(),this.items=[],this.options=t,this.value=t.items[t.selectedItem],this.selected=t.selectedItem,this.view=new k({type:t.type,elementsMargin:t.elementsMargin}),t.items.forEach((i,s)=>{const e=typeof t.style.bg=="string"?new p(g.from(t.style.bg)):this.getGraphics(t.style.bg),h=typeof t.style.checked=="string"?new p(g.from(t.style.checked)):this.getGraphics(t.style.checked),o=new T({text:i,checked:t.selectedItem===s,style:{unchecked:e,checked:h,text:t.style.textStyle}});this.view.addChild(o),o.onChange.connect(()=>this.selectItem(s)),this.items.push(o),this.view.addChild(o)}),this.onChange=new x}getGraphics({color:t,fillColor:i,width:s,height:e,radius:h,padding:o}){const n=new m().beginFill(t),a=s===e&&h>=s/2;if(a?n.drawCircle(s/2,s/2,s/2):n.drawRoundedRect(0,0,s,e,h),i!==void 0){n.beginFill(i);const c=s/2;a?n.drawCircle(c,c,c-o):n.drawRoundedRect(o,o,s-o*2,e-o*2,h)}return n}selectItem(t){this.selected=t,this.items.map(i=>i.checked=!1),this.items[t].checked=!0,this.value=this.options.items[this.selected],this.onChange.emit(this.selected,this.value)}}class Y{constructor(t={}){this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=t,this._options.max=t.max||160,this._options.damp=t.damp||.8,this._options.springiness=t.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}class V{constructor(){this._spring=new Y,this._pos=0,this.to=0}start(t,i,s){this._speed=t,this._pos=i,this.to=s,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const e=this.to-this._pos,h=Math.abs(e)/e,o=Math.abs(this._speed)/this._speed;h!==o?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}class D{constructor(t={}){this.position=0,this.constrain=!0,this.min=0,this.max=0,this.maxSpeed=400,this._offset=0,this._prev=0,this._speed=0,this._targetSpeed=0,this._speedChecker=0,this._grab=0;var i,s,e;this.constrain=(i=t.constrain)!=null?i:!0,this.maxSpeed=(s=t.maxSpeed)!=null?s:400,this._ease=(e=t.ease)!=null?e:new V}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(){this._hasStopped||(this.constrain?this._updateConstrain():this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(){const t=this.max;this.position>this.min||this.position<t||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,t)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}class X{constructor(t){this.xAxis=new D({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new D({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this._frame=new C,this._bounds=new C,this._globalPosition=new _}pointerDown(t){this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(),this.yAxis.slide())}resize(t,i){this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=i,this._dirty=!0}setBounds(t,i,s,e){this._bounds.x=t,this._bounds.width=i-t,this._bounds.y=s,this._bounds.height=e-s,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}class B extends u{constructor(t){var i,s,e;super(),this.__width=0,this.__height=0,this.freeSlot={x:0,y:0},this.isDragging=0,this.childrenInteractiveStorage=[],this.ticker=F.shared,this.options=t,this.addBackground(),this.__width=t.width|this.background.width,this.__height=t.height|this.background.height,t.vertPadding||(t.vertPadding=(i=t.padding)!=null?i:0),t.horPadding||(t.horPadding=(s=t.padding)!=null?s:0),this.layout=new k({type:t.type,elementsMargin:t.elementsMargin,vertPadding:t.vertPadding,horPadding:t.horPadding}),super.addChild(this.layout),(e=t.items)!=null&&e.length&&t.items.forEach(o=>{this.addItem(o)}),this.hasBounds&&(this.addMask(),this.makeScrollable()),this.onMouseScrollBinded=this.onMouseScroll.bind(this);const h=new V;this._trackpad=new X({constrain:!0,yEase:h}),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.resize(),this.ticker.add(this.update,this)}get hasBounds(){return!!this.__width||!!this.__height}onChildrenChange(){}addItem(...t){var i,s;if(t.length>1)t.forEach(e=>this.addItem(e));else{const e=t[0];(!e.width||!e.height)&&console.error("ScrollBox item should have size"),e.x=this.freeSlot.x,e.y=this.freeSlot.y,this.layout.addChild(e),this.options.disableDynamicRendering||(e.renderable=this.isItemVisible(e));const h=(s=(i=this.options)==null?void 0:i.elementsMargin)!=null?s:0;switch(this.options.type){case"horizontal":this.freeSlot.x+=h+e.width;break;default:this.freeSlot.y+=h+e.height;break}}return this.resize(),t[0]}removeItem(t){const i=this.layout.children[t];i&&(this.layout.removeChild(i),this.resize())}isItemVisible(t){const i=this.options.type==="vertical"||!this.options.type;let s=!1;const e=this.layout;if(i){const h=t.y+e.y;h+t.height+this.options.vertPadding>=0&&h-this.options.vertPadding-this.options.elementsMargin<=this.options.height&&(s=!0)}else{const h=t.x+e.x;h+t.width>=0&&h<=this.options.width&&(s=!0)}return s}get items(){var t,i;return(i=(t=this.layout)==null?void 0:t.children)!=null?i:[]}addBackground(){this.background=typeof this.options.background=="string"?new p(g.from(this.options.background)):new m,this.addChild(this.background),this.resize()}addMask(){this.borderMask=new m,super.addChild(this.borderMask),this.mask=this.borderMask,this.resize()}makeScrollable(){this.on("pointerdown",s=>{this.isDragging=1,this._trackpad.pointerDown(s.global)}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("pointermove",s=>{this._trackpad.pointerMove(s.global),this.isDragging&&this.disableChildrenInteractivity()});const{onMouseHover:t,onMouseOut:i}=this;this.on("mouseover",t,this).on("mouseout",i,this)}disableChildrenInteractivity(){this.items.forEach((t,i)=>{this.childrenInteractiveStorage[i]||(this.childrenInteractiveStorage[i]=t.interactive===!0),t.interactive=!1})}restoreChildrenInteractivity(){this.items.forEach((t,i)=>{const s=this.childrenInteractiveStorage[i]===!0;s&&(t.interactive=s,delete this.childrenInteractiveStorage[i])})}setInteractive(t){this.interactive=t}get layoutHeight(){return this.layout.height+this.options.vertPadding*2}get layoutWidth(){return this.layout.width+this.options.horPadding*2}resize(){if(this.renderAllItems(),this.borderMask&&(this.lastWidth!==this.layoutWidth||this.lastHeight!==this.layoutHeight)){const t=this.options.vertPadding,i=this.options.horPadding;this.options.width||(this.__width+=this.layoutWidth),this.options.height||(this.__height+=this.layoutHeight),this.borderMask.clear().lineStyle(0).beginFill(16777215).drawRoundedRect(0,0,this.__width,this.__height,this.options.radius|0),M(this.borderMask),this.background instanceof m&&typeof this.options.background=="number"&&this.background.clear().lineStyle(0).beginFill(this.options.background).drawRect(0,0,this.__width+i,this.__height+t),this.options.type==="horizontal"?this.setInteractive(this.layoutWidth>this.__width):this.setInteractive(this.layoutHeight>this.__height),this.lastWidth=this.layoutWidth,this.lastHeight=this.layoutHeight}if(this._trackpad){const t=this.borderMask.width-this.layout.width-this.options.horPadding*2,i=this.borderMask.height-this.layout.height-this.options.vertPadding*2;this.options.type==="vertical"?this._trackpad.yAxis.max=-Math.abs(i):this.options.type==="horizontal"?this._trackpad.xAxis.max=-Math.abs(t):(this._trackpad.yAxis.max=-Math.abs(i),this._trackpad.xAxis.max=-Math.abs(t))}this.stopRenderHiddenItems()}onMouseHover(){this.renderAllItems(),document.addEventListener("mousewheel",this.onMouseScrollBinded),document.addEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseOut(){this.stopRenderHiddenItems(),document.removeEventListener("mousewheel",this.onMouseScrollBinded),document.removeEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseScroll(t){if(this.renderAllItems(),this.options.type==="horizontal"&&(typeof t.deltaX!="undefined"||typeof t.deltaY!="undefined")){const i=t.deltaY?this.layout.x-t.deltaY:this.layout.x-t.deltaX;i<0&&i+this.layoutWidth+this.options.horPadding<this.__width?this._trackpad.xAxis.value=this.__width-this.layoutWidth:i>this.options.horPadding?this._trackpad.xAxis.value=0:this._trackpad.xAxis.value=i}else if(typeof t.deltaY!="undefined"){const i=this.layout.y-t.deltaY;i<0&&i+this.layoutHeight+this.options.vertPadding<this.__height?this._trackpad.yAxis.value=this.__height-this.layoutHeight:i>this.options.vertPadding?this._trackpad.yAxis.value=0:this._trackpad.yAxis.value=i}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.layout.children.length-1):this.scrollTop()}scrollTop(){this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0}renderAllItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=this.isItemVisible(t)})}scrollTo(t){if(!this.interactive)return;const i=this.layout.children[t];i&&(this._trackpad.xAxis.value=this.options.type==="horizontal"?this.__width-i.x-i.width-this.options.horPadding:0,this._trackpad.yAxis.value=!this.options.type||this.options.type==="vertical"?this.__height-i.y-i.height-this.options.vertPadding:0)}get height(){return this.__height}get width(){return this.__width}update(){this._trackpad.update(),this.options.type==="horizontal"?this.layout.x!==this._trackpad.x?(this.renderAllItems(),this.layout.x=this._trackpad.x):this.stopRenderHiddenItems():this.layout.y!==this._trackpad.y?(this.renderAllItems(),this.layout.y=this._trackpad.y):this.stopRenderHiddenItems()}}var N=Object.defineProperty,E=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,P=(r,t,i)=>t in r?N(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i,K=(r,t)=>{for(var i in t||(t={}))q.call(t,i)&&P(r,i,t[i]);if(E)for(var i of E(t))J.call(t,i)&&P(r,i,t[i]);return r};class Q extends u{constructor({closedBG:t,textStyle:i,items:s,openBG:e,selected:h,selectedTextOffset:o,scrollBox:n}){var a,c;super(),this.closedBG=typeof t=="string"?new p(g.from(t)):t,this.openBG=typeof e=="string"?new p(g.from(e)):e,this.openBG.visible=!1,this.addChild(this.closedBG,this.openBG);const d=new y({view:this.closedBG});this.addChild(d),d.onPress.connect(()=>this.toggle()),this.selectedText=new b(s!=null&&s.items?s.items[0]:"",i);const w=new y({view:this.selectedText});w.onPress.connect(()=>this.toggle()),this.addChild(w),this.selectedText.anchor.set(.5),this.selectedText.x=this.closedBG.width/2+((o==null?void 0:o.x)||0),this.selectedText.y=this.closedBG.height/2+((o==null?void 0:o.y)||0),this.scrollBox=new B(K({type:"vertical",elementsMargin:0,width:this.closedBG.width,height:this.closedBG.height*5,radius:0,padding:0},n)),this.openBG.addChild(this.scrollBox),this.scrollBox.y=this.closedBG.height,n!=null&&n.offset&&(this.scrollBox.x+=(a=n.offset.x)!=null?a:0,this.scrollBox.y+=(c=n.offset.y)!=null?c:0),this.onSelect=new x,this.convertItemsToButtons(s).forEach((l,v)=>{const f=l.getText();v===h&&(this.selectedText.text=f),l.onPress.connect(()=>{this.value=v,this.onSelect.emit(v,f),this.selectedText.text=f,this.close()}),this.scrollBox.addItem(l)})}toggle(){this.openBG.visible=!this.openBG.visible,this.closedBG.visible=!this.closedBG.visible}open(){this.openBG.visible=!0,this.closedBG.visible=!1}close(){this.openBG.visible=!1,this.closedBG.visible=!0}convertItemsToButtons({items:t,backgroundColor:i,hoverColor:s,width:e,height:h,textStyle:o,radius:n}){const a=[];return t.forEach(c=>{const d=new m().beginFill(i).drawRoundedRect(0,0,e,h,n),w=new m().beginFill(s!=null?s:i).drawRoundedRect(0,0,e,h,n),l=new b(c,o),v=new y({view:d,hoverView:w,textView:l});a.push(v)}),a}update(){this.scrollBox.update()}}class Z extends u{constructor(t){var i,s,e,h;super(),this.dragging=0,this.percent=100,this.value=0,this.onChange=new x,this.options=t;const o=typeof t.bg=="string"?new p(g.from(t.bg)):t.bg;if(this.bg=new u,this.bg.addChild(o),this.addChild(this.bg),t.fill){const a=typeof t.fill=="string"?new p(g.from(t.fill)):t.fill;this.fill=new u,this.fill.addChild(a);const c=(s=(i=t.fillOffset)==null?void 0:i.x)!=null?s:0,d=(h=(e=t.fillOffset)==null?void 0:e.y)!=null?h:0;this.fill.x=(this.bg.width-this.fill.width)/2+c,this.fill.y=(this.bg.height-this.fill.height)/2+d,this.fillMask=new m,this.fill.addChild(this.fillMask),this.fill.mask=this.fillMask,this.addChild(this.fill)}const n=typeof t.slider=="string"?new p(g.from(t.slider)):t.slider;n.x=n.width/2,this.slider=new u,this.slider.addChild(n),n instanceof p&&n.anchor.set(.5),this.slider.y=this.bg.height/2,this.addChild(this.slider),t.showValue&&(this.valueText=new b("",t.valueTextStyle||{fill:16777215}),this.valueText.anchor.set(.5),this.addChild(this.valueText)),this.makeScrollable(),this.validateSettings(),this.update()}validateSettings(){var t,i;const{options:s}=this;s.min||(s.min=0),s.max||(s.max=100),s.value<s.min&&(s.value=s.min),s.value>s.max&&(s.value=s.max),this.value=(i=(t=s.value)!=null?t:s.min)!=null?i:0,this.percent=this.value*100/s.max;const e=s.max-s.min,h=this.value-s.min;this.percent=h*100/e}makeScrollable(){this.interactive=!0,this.slider.interactive=!0,this.bg.interactive=!0;const{onSetByClick:t,onDragStart:i,onDragMove:s,onDragEnd:e}=this;this.slider.on("pointerdown",i,this).on("pointermove",s,this).on("pointerup",e,this).on("pointerupoutside",e,this),this.bg.on("pointerdown",t,this),this.on("pointerupoutside",e,this),M(this.fill,this.valueText)}onSetByClick(t){var i;let s=t.currentTarget.parent.worldTransform.applyInverse(t.global).x-this.slider.width/2;s<0&&(s=0),s<0&&(s=0);const e=this.bg.width-this.slider.width;s>e&&(s=e),this.percent=Math.round(s/e*100),this.value=this.options.min+Math.round((this.options.max-this.options.min)/100*this.percent),this.update(),(i=this.onChange)==null||i.emit(this.value)}onDragStart(t){const i=t.currentTarget;i.dragData=t,this.dragging=1,i.dragPointerStart=i.parent.worldTransform.applyInverse(t.global),i.dragObjStart=new _,i.dragObjStart.copyFrom(i.position),i.dragGlobalStart=new _,i.dragGlobalStart.copyFrom(t.data.global)}onDragMove(t){var i,s;const e=t.currentTarget;if(!this.dragging)return;const h=e.dragData;if(this.dragging===1&&Math.abs(h.global.x-((i=e.dragGlobalStart)==null?void 0:i.x))+Math.abs(h.global.y-((s=e.dragGlobalStart)==null?void 0:s.y))>=3&&(this.dragging=2),this.dragging===2){const o=e.parent.worldTransform.applyInverse(h.global);let n=e.dragObjStart.x+(o.x-e.dragPointerStart.x);n<0&&(n=0);const a=this.bg.width-this.slider.width;n>a&&(n=a),this.percent=Math.round(n/a*100),this.value=this.options.min+Math.round((this.options.max-this.options.min)/100*this.percent),this.update()}}onDragEnd(){var t;this.dragging&&(this.dragging=0,(t=this.onChange)==null||t.emit(this.value))}update(t){var i,s,e,h,o;const n=t!=null?t:(this.bg.width-this.slider.width)/100*this.percent;this.slider.x=n;const a=0,c=this.bg.width/100*this.percent;if(this.fillMask&&this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(a,0,c-a,this.fill.height),this.options.showValue){this.valueText.text=this.value;const d=this.slider.x+this.slider.width/2,w=this.slider.y;this.valueText.x=d+((s=(i=this.options.valueTextOffset)==null?void 0:i.x)!=null?s:0),this.valueText.y=w+((h=(e=this.options.valueTextOffset)==null?void 0:e.y)!=null?h:0)}(o=this.onChange)==null||o.emit(this.value)}}export{y as Button,T as CheckBox,H as DoubleSlider,z as Input,k as Layout,L as MaskedFrame,W as RadioGroup,B as ScrollBox,Q as Select,Z as Slider,I as Switch,U as col,j as row};
//# sourceMappingURL=pixi-ui.mjs.map
