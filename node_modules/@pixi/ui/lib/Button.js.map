{"version":3,"file":"Button.js","sources":["../src/Button.ts"],"sourcesContent":["import { utils } from '@pixi/core';\nimport { Container } from '@pixi/display';\nimport { FederatedPointerEvent } from '@pixi/events';\nimport { Text } from '@pixi/text';\nimport { Signal } from 'typed-signals';\n\nexport interface ButtonOptions\n{\n    view: Container;\n    hoverView?: Container;\n    pressedView?: Container;\n    disabledView?: Container;\n    textView?: Text;\n    padding?: number;\n    textOffset?: { x: number; y: number };\n}\n\n/**\n * Container based component that gives us a starting point for UI buttons.\n * It composes a view rather than extends one, this means we can easily make any pixi container a button!\n * @example\n * ```\n * const spriteButton = new Button({\n *     view: new PixiSprite(Texture.from(`button.png`)),\n *     hoverView: new PixiSprite(Texture.from(`button_hover.png`)),\n *     pressedView: new PixiSprite(Texture.from(`button_pressed.png`)),\n *     disabledView: new PixiSprite(Texture.from(`button_disabled.png`)),\n *     textView: new Text(text, { fill: 0xFFFFFF }),\n * });\n *\n * const graphicsButton = new Button({\n *     view: new PixiGraphics().beginFill(color).drawRoundedRect(0, 0, width, height, radius),\n *     hoverView: new PixiGraphics().beginFill(hoverColor).drawRoundedRect(0, 0, width, height, radius),\n *     pressedView: new PixiGraphics().beginFill(pressedColor).drawRoundedRect(0, 0, width, height, radius),\n *     disabledView: new PixiGraphics().beginFill(disabledColor).drawRoundedRect(0, 0, width, height, radius),\n *     textView: new Text(text, { fill: 0xFFFFFF }),\n *     padding: 10,\n *     textOffset: { x: 10, y: 1 },\n * });\n *\n * ```\n */\nexport class Button extends Container\n{\n    /** TODO */\n    public defaultView: Container;\n    /** TODO */\n    public hoverView: Container;\n    /** TODO */\n    public pressedView: Container;\n    /** TODO */\n    public disabledView: Container;\n    /** TODO */\n    public text: Text;\n\n    /** TODO */\n    public onPress: Signal<(btn?: this, e?: FederatedPointerEvent) => void>;\n    /** TODO */\n    public onDown: Signal<(btn?: this, e?: FederatedPointerEvent) => void>;\n    /** TODO */\n    public onUp: Signal<(btn?: this, e?: FederatedPointerEvent) => void>;\n    /** TODO */\n    public onHover: Signal<(btn?: this, e?: FederatedPointerEvent) => void>;\n    /** TODO */\n    public onOut: Signal<(btn?: this, e?: FederatedPointerEvent) => void>;\n    /** TODO */\n    public onUpOut: Signal<(btn?: this, e?: FederatedPointerEvent) => void>;\n\n    private _isDown: boolean;\n    private _enabled: boolean;\n    private _shown: boolean;\n\n    private padding = 0;\n\n    constructor({\n        view,\n        hoverView,\n        pressedView,\n        disabledView,\n        textView,\n        padding,\n        textOffset,\n    }: ButtonOptions)\n    {\n        super();\n\n        if (padding)\n        {\n            this.padding = padding * 2;\n        }\n\n        this.defaultView = view;\n        this.defaultView.zIndex = 1;\n        this.addChild(this.defaultView);\n\n        if (hoverView)\n        {\n            this.hoverView = hoverView;\n            this.hoverView.zIndex = 2;\n            this.addChild(this.hoverView);\n            this.hoverView.visible = false;\n        }\n\n        if (pressedView)\n        {\n            this.pressedView = pressedView;\n            this.pressedView.zIndex = 3;\n            this.addChild(this.pressedView);\n            this.pressedView.visible = false;\n        }\n\n        if (disabledView)\n        {\n            this.disabledView = disabledView;\n            this.disabledView.zIndex = 4;\n            this.addChild(this.disabledView);\n            this.disabledView.visible = false;\n        }\n\n        if (textView)\n        {\n            this.text = textView;\n            this.text.zIndex = 4;\n            textView.anchor.set(0.5);\n\n            textView.x = (this.width / 2) + (textOffset?.x ?? 0);\n            textView.y = (this.height / 2) + (textOffset?.y ?? 0);\n\n            this.addChild(this.text);\n\n            if (textView.width + this.padding > this.defaultView?.width)\n            {\n                const maxWidth = this.defaultView?.width;\n\n                textView.scale.set(maxWidth / (textView.width + this.padding));\n            }\n        }\n\n        this._enabled = true;\n\n        this.onPress = new Signal();\n        this.onDown = new Signal();\n        this.onUp = new Signal();\n        this.onHover = new Signal();\n        this.onOut = new Signal();\n        this.onUpOut = new Signal();\n\n        this.on('pointerdown', (e: FederatedPointerEvent) =>\n        {\n            this._isDown = true;\n            this.onDown.emit(this, e);\n        });\n\n        this.on('pointerup', (e: FederatedPointerEvent) =>\n        {\n            this._processUp(e);\n        });\n\n        this.on('pointerupoutside', (e: FederatedPointerEvent) =>\n        {\n            this._processUpOut(e);\n        });\n\n        this.on('pointertap', (e: FederatedPointerEvent) =>\n        {\n            this._isDown = false;\n            this.onPress.emit(this, e);\n        });\n\n        this.on('pointerover', (e: FederatedPointerEvent) =>\n        {\n            this.onHover.emit(this, e);\n        });\n\n        this.on('pointerout', (e: FederatedPointerEvent) =>\n        {\n            this._processOut(e);\n        });\n\n        this.onDown.connect((_btn, e) =>\n        {\n            this.down(e);\n            if (this.pressedView)\n            {\n                this.pressedView.visible = true;\n            }\n        });\n\n        this.onUp.connect((_btn, e) =>\n        {\n            this.up(e);\n            if (this.pressedView)\n            {\n                this.pressedView.visible = false;\n            }\n        });\n\n        this.onUpOut.connect((_bth, e) =>\n        {\n            this._upOut(e);\n            if (this.pressedView)\n            {\n                this.pressedView.visible = false;\n            }\n        });\n\n        if (!utils.isMobile.any)\n        {\n            this.onHover.connect((_bth, e) =>\n            {\n                if (this.hoverView)\n                {\n                    this.hoverView.visible = true;\n                }\n                this.hover(e);\n            });\n        }\n\n        this.onOut.connect((_bth, e) =>\n        {\n            if (this.hoverView)\n            {\n                this.hoverView.visible = false;\n            }\n            this._out(e);\n        });\n\n        this._isDown = false;\n\n        this.enabled = true;\n    }\n\n    /**\n     * TODO\n     * @param _e\n     */\n    public down(_e?: FederatedPointerEvent): void\n    {\n        // override me!\n    }\n\n    /**\n     * TODO\n     * @param _e\n     */\n    public up(_e?: FederatedPointerEvent): void\n    {\n        // override me!\n    }\n\n    /**\n     * TODO\n     * @param _e\n     */\n    public hover(_e?: FederatedPointerEvent): void\n    {\n        // override me!\n    }\n\n    /** TODO */\n    public getText(): string\n    {\n        return this.text.text;\n    }\n\n    /** TODO */\n    get isDown(): boolean\n    {\n        return this._isDown;\n    }\n\n    /** TODO */\n    set enabled(value: boolean)\n    {\n        this._enabled = value;\n        this.interactive = value;\n        this.cursor = value ? 'pointer' : 'default';\n\n        if (this.disabledView)\n        {\n            this.disabledView.visible = !value;\n        }\n\n        if (!value)\n        {\n            this._processUp();\n        }\n    }\n\n    /** TODO */\n    get enabled(): boolean\n    {\n        return this._enabled;\n    }\n\n    /** TODO */\n    set shown(value: boolean)\n    {\n        this._shown = value;\n        this.enabled = value;\n        if (this.defaultView)\n        {\n            this.defaultView.visible = value;\n        }\n    }\n\n    /** TODO */\n    get shown(): boolean\n    {\n        return this._shown;\n    }\n\n    private _processUp(e?: FederatedPointerEvent): void\n    {\n        if (this._isDown)\n        {\n            this.onUp.emit(this, e);\n        }\n        this._isDown = false;\n    }\n\n    private _processUpOut(e?: FederatedPointerEvent): void\n    {\n        if (this._isDown)\n        {\n            this.onUpOut.emit(this, e);\n        }\n\n        if (this.pressedView)\n        {\n            this.pressedView.visible = false;\n        }\n        this._isDown = false;\n    }\n\n    private _processOut(e?: FederatedPointerEvent): void\n    {\n        this.onOut.emit(this, e);\n        this._isDown = false;\n    }\n\n    private _upOut(e?: FederatedPointerEvent): void\n    {\n        this.up(e);\n    }\n\n    private _out(e?: FederatedPointerEvent): void\n    {\n        this.up(e);\n    }\n}\n"],"names":["Container","Signal","utils"],"mappings":"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"}